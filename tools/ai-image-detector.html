<!--
============================================
AI IMAGE DETECTOR v1.0
============================================
Description: Browser-based AI-generated image detection tool
using FFT noise analysis and forensic signal processing.

Dependencies: None (Vanilla JavaScript)

Project: Tools Hub by Jesse Anderson
Repository: https://github.com/jesse-anderson/Tools
License: GPL-3.0 - https://github.com/jesse-anderson/Tools/blob/main/LICENSE

Features:
- Custom Cooley-Tukey FFT implementation (2D separable)
- Laplacian high-pass edge detection filtering
- Channel-specific analysis (RGB, Luminance)
- Configurable FFT size and Hanning windowing
- Interactive pan/zoom source viewport
- Polar spectrum unwrapping visualization
- Azimuthal and radial frequency analysis graphs
- Template images for real vs. AI comparison

Methodology:
Analyzes frequency domain artifacts in the blue channel
(where compression/generation defects are most visible)
to detect checkerboard patterns characteristic of CNN
upsampling artifacts in generative AI images.

Last Updated: January 2025
============================================
-->
<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Image Detector - FFT Noise Analysis | Tools Hub</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/shared.css">
    <link rel="stylesheet" href="../css/ai_image_detector/ai-image-detector.css">

</head>
<body>
    <div class="container">
        <header>
            <div class="header-content" style="display:flex; justify-content:space-between; align-items:center;">
                <div class="header-left">
                    <a href="../tools.html" class="back-link">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="19" y1="12" x2="5" y2="12"/>
                            <polyline points="12 19 5 12 12 5"/>
                        </svg>
                        Back to Tools
                    </a>
                </div>
                <div class="header-right">
                    <div class="theme-toggle">
                        <button data-theme-toggle="light" aria-pressed="false" title="Light mode">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="5"/>
                                <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
                            </svg>
                        </button>
                        <button data-theme-toggle="dark" aria-pressed="false" title="Dark mode">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
            <div style="margin-top: 24px; margin-bottom:24px; display: flex; align-items: center; gap: 16px;">
                <div class="tool-icon-header engineering" style="font-size: 2rem;">üëÅÔ∏è</div>
                <div>
                    <h1 style="margin:0; font-size:1.5rem; font-weight:700;">AI Image Detector</h1>
                    <p class="tagline" style="margin:0; color:var(--text-muted); font-family:'JetBrains Mono'; font-size:0.8rem;">// DECOUPLED METRICS ‚Ä¢ LINEAR SCORING</p>
                </div>
            </div>
        </header>

        <main>
            <div class="calculator-layout">
                <aside class="panel">
                    <div class="panel-header">
                        <h2>Parameters</h2>
                        <p>Forensic Configuration</p>
                    </div>

                    <input type="file" id="fileInput" accept="image/*" aria-label="Upload image for AI analysis" hidden>
                    <div class="upload-zone" id="dropZone"
     role="button"
     tabindex="0"
     aria-label="Upload image for AI analysis">
                        <svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="17 8 12 3 7 8"/>
                            <line x1="12" y1="3" x2="12" y2="15"/>
                        </svg>
                        <div class="upload-text">Upload Image</div>
                    </div>

                    <div class="control-group">
                        <div class="control-label">Signal Filter</div>
                        <select id="signalSelect" class="control-select">
                            <option value="laplacian" selected>Laplacian (High-Pass Edge)</option>
                            <option value="raw">Raw Intensity (Unfiltered)</option>
                        </select>
                    </div>

                    <div class="control-group">
                        <div class="control-label">Channel</div>
                        <select id="channelSelect" class="control-select">
                            <option value="blue" selected>Blue Channel (Best for AI)</option>
                            <option value="green">Green Channel</option>
                            <option value="red">Red Channel</option>
                            <option value="luma">Luminance (Gray)</option>
                        </select>
                    </div>

                    <div class="control-group">
                        <div class="control-label">FFT Size</div>
                        <select id="fftSizeSelect" class="control-select">
                            <option value="native" selected>Native (Best Quality)</option>
                            <option value="1024">1024px</option>
                            <option value="2048">2048px</option>
                            <option value="4096">4096px</option>
                        </select>
                    </div>

                    <div class="control-group">
                        <div class="control-label">FFT Engine</div>
                        <select id="fftEngineSelect" class="control-select">
                            <option value="auto" selected>Auto (WASM preferred)</option>
                            <option value="wasm">Rust/WASM (Fast)</option>
                            <option value="js">JavaScript (Compatible)</option>
                        </select>
                        <div class="engine-status" id="engineStatus">
                            <span class="status-dot"></span>
                            <span class="status-text">Detecting...</span>
                        </div>
                    </div>

                    <div class="control-group">
                        <div class="control-label">Performance</div>
                        <div class="perf-stats" id="perfStats">
                            <div class="perf-row">
                                <span class="perf-label">FFT Time:</span>
                                <span class="perf-value" id="fftTime">--</span>
                            </div>
                        </div>
                    </div>

                    <div class="control-group">
                        <div class="control-label">Toggles</div>
                        <label class="checkbox-label" for="windowCheck" title="Applies smoothing window. Turn OFF to see edge artifacts more clearly.">
                            <input type="checkbox" id="windowCheck" class="checkbox-input">
                            <span>Hanning Window</span>
                        </label>
                        <label class="checkbox-label" for="logScaleCheck" title="Only affects visualization. Scoring is always Linear.">
                            <input type="checkbox" id="logScaleCheck" class="checkbox-input">
                            <span>Visual Log Scale</span>
                        </label>
                    </div>

                    <div class="template-section">
                        <div class="control-label">Templates</div>
                        <div class="template-grid">
                            <button class="template-btn" onclick="loadTemplate('../img/tree.jpg')"><div class="template-status status-real"></div><span>Real</span></button>
                            <button class="template-btn" onclick="loadTemplate('../img/tree_scan.jpg')"><div class="template-status status-real"></div><span>Scan</span></button>
                            <button class="template-btn" onclick="loadTemplate('../img/tree-midjourney.png')"><div class="template-status status-ai"></div><span>MidJ</span></button>
                            <button class="template-btn" onclick="loadTemplate('../img/tree-nano-banana.png')"><div class="template-status status-ai"></div><span>Nano</span></button>
                        </div>
                    </div>
                </aside>

                <div class="panel">
                    <div class="panel-header">
                        <div style="display:flex; justify-content:space-between; align-items:center;">
                            <div>
                                <h2>Forensic Dashboard</h2>
                                <p id="imgInfo">No Image Loaded</p>
                            </div>
                        </div>
                    </div>

                    <div class="analysis-grid">

                        <div class="viewport-card">
                            <div class="viewport-header">
                                <span>Source</span>
                                <span style="font-size:0.7rem; color:var(--text-muted)">Pan & Zoom Enabled</span>
                            </div>
                            <div class="viewport-content" id="sourceContainer">
                                <canvas id="sourceCanvas"></canvas>
                            </div>
                        </div>

                        <div class="viewport-card">
                            <div class="viewport-header">
                                <span>Power Spectrum (FFT)</span>
                                <span style="font-size:0.7rem; color:var(--accent-engineering)">Magma</span>
                            </div>
                            <div class="viewport-content" id="fftContainer">
                                <canvas id="fftCanvas"></canvas>
                                <div class="processing-overlay" id="fftLoader">
                                    <div class="loader-spinner"></div>
                                    <div class="processing-text" id="statusText">READY</div>
                                    <progress id="progressBar" value="0" max="100"></progress>
                                </div>
                            </div>
                        </div>

                        <div class="viewport-card">
                            <div class="viewport-header">
                                <span>Polar Spectrum (Unwrapped)</span>
                                <span style="font-size:0.7rem; color:var(--text-muted)">X: Angle | Y: Freq</span>
                            </div>
                            <div class="viewport-content" style="background:#111;">
                                <canvas id="polarCanvas"></canvas>
                            </div>
                        </div>

                        <div class="viewport-card">
                            <div class="viewport-header">
                                <span>Azimuthal Sum</span>
                                <span>X: Angle | Y: Power</span>
                            </div>
                            <div class="viewport-content">
                                <canvas id="azimuthalCanvas"></canvas>
                            </div>
                        </div>

                        <div class="viewport-card">
                            <div class="viewport-header">
                                <span>Radial Falloff</span>
                                <span>X: Frequency | Y: Power</span>
                            </div>
                            <div class="viewport-content">
                                <canvas id="radialCanvas"></canvas>
                            </div>
                        </div>

                    </div>

                    <div class="guide-box">
                        <div class="guide-title">
                            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <line x1="12" y1="16" x2="12" y2="12"/>
                                <line x1="12" y1="8" x2="12.01" y2="8"/>
                            </svg>
                            Analysis Quick Guide
                        </div>
                        <div class="guide-content">
                            <p><strong>1. Log Visuals vs. Linear Truth:</strong> The images use Log scaling so you can see them. Internally, we score using Linear power to catch "invisible" grid spikes that are mathematically massive. This is standard practice in signal processing‚Äîlog for visibility, linear for accuracy.</p>

                            <p><strong>2. Why Laplacian?</strong> We run a High-Pass filter (3√ó3 Laplacian kernel) to strip image content. The filter sums to zero, guaranteeing removal of the DC component (average brightness). We're looking for the manufacturing defects of the generator, not the picture itself.</p>

                            <p><strong>3. Artifact Identification:</strong>
                                <ul>
                                    <li><strong>Star Field / Grid:</strong> Periodic grid indicates upsampling artifacts from transposed convolutions (checkerboard effect). Most common in GANs (StyleGAN1/2, ProGAN) and early diffusion models.</li>
                                    <li><strong>Solid Halo / Ring:</strong> Indicates heavy JPEG compression, aggressive post-processing, or Gaussian blurring.</li>
                                    <li><strong>Natural Falloff:</strong> Real photographs typically exhibit chaotic, non-periodic frequency distributions without geometric patterns.</li>
                                </ul>
                            </p>

                            <p><strong>4. Model Effectiveness:</strong>
                                <ul>
                                    <li><strong>Best Results:</strong> GAN-generated faces (StyleGAN, ProGAN, BigGAN), AI upscalers, and images with known upsampling artifacts.</li>
                                    <li><strong>Limited Results:</strong> Modern diffusion models (SDXL, DALL-E 3, Midjourney v6+) have largely eliminated checkerboard artifacts through alternative upsampling methods.</li>
                                    <li><strong>Not Reliable For:</strong> Determining if an image is AI-generated with certainty (use this as one tool among many).</li>
                                </ul>
                            </p>
                        </div>
                    </div>

                    <details class="tech-foldable">
                        <summary>Technical Methodology & Signal Processing</summary>
                        <div class="tech-content">
                            <h3>1. The Pipeline</h3>
                            <p>
                                Unlike simple metadata checkers, this tool performs frequency domain analysis. The image is processed in five stages:
                                <br>
                                <code>Input Image -> Blue Channel Extraction -> Laplacian High-Pass -> Hanning Window -> FFT</code>
                            </p>

                            <h3>2. Channel Selection (Blue Channel)</h3>

                            <p>
                                We default to the <strong>Blue Channel</strong>. In digital sensors using a Bayer Filter, color sampling is non-uniform: 50% green, 25% red, 25% blue. The blue channel has the lowest sampling density and typically the lowest signal-to-noise ratio. Compression artifacts and generation errors are most prominent in this channel‚Äîmaking it the "canary in the coal mine" for forensic analysis.
                            </p>

                            <h3>3. Edge Detection (Laplacian High-Pass)</h3>

                            <p>
                                A 3√ó3 Laplacian kernel acts as a second-order derivative filter. Because the kernel sums to zero, it guarantees removal of the DC component (average pixel intensity), leaving only high-frequency content. This effectively removes the "picture" (faces, objects, scenes) and reveals the underlying "texture" (pixel-level relationships, compression artifacts, generation defects).
                            </p>

                            <h3>4. Windowing (Hanning)</h3>

                            <p>
                                Before FFT, a Hanning window is optionally applied to reduce spectral leakage. Image boundaries create artificial discontinuities (sharp edges) that would appear as spurious high-frequency content. The window tapers these edges smoothly to zero, minimizing artifacts at the cost of slight frequency resolution reduction. Disable this to see edge artifacts more clearly.
                            </p>

                            <h3>5. Frequency Domain (FFT)</h3>

                            <p>
                                We use a Fast Fourier Transform to convert spatial data (pixels) into frequency data (sine wave components). The output is centered (fftshift) so low frequencies appear at the center.
                            </p>
                            <p>
                                <strong>Center:</strong> Low frequencies (gradual gradients, smooth regions)<br>
                                <strong>Edges:</strong> High frequencies (sharp edges, noise, fine detail)
                            </p>
                            <p>
                                <strong>Transposed Convolutions & Checkerboard Artifacts:</strong><br>
                                Many GANs and older generative models use transposed convolutions (also called deconvolution) for upsampling. This operation can create checkerboard patterns in the spatial domain‚Äîsubtle enough to be invisible to the eye, but mathematically regular. In the frequency domain, these artifacts manifest as a periodic grid or star pattern at regular intervals, corresponding to the upsampling factor.
                            </p>

                            <h3>6. FFT Engine: WASM vs JavaScript</h3>

                            <p>
                                The tool supports two FFT implementations with automatic fallback:
                            </p>
                            <p style="margin-left: 12px;">
                                <strong>WASM (Rust) ‚Äì Preferred:</strong><br>
                                <span style="color: var(--text-secondary);">‚Ä¢ Handles any image dimensions (not limited to powers of 2)</span><br>
                                <span style="color: var(--text-secondary);">‚Ä¢ 3-10x faster through native compiled code and SIMD optimizations</span><br>
                                <span style="color: var(--text-secondary);">‚Ä¢ Uses Rust's FFT library for production-grade accuracy</span><br>
                                <span style="color: var(--text-secondary);">‚Ä¢ Returns centered output directly (no post-shift needed)</span>
                            </p>
                            <p style="margin-left: 12px;">
                                <strong>JavaScript ‚Äì Fallback:</strong><br>
                                <span style="color: var(--text-secondary);">‚Ä¢ Custom Cooley-Tukey implementation (requires power-of-2 dimensions)</span><br>
                                <span style="color: var(--text-secondary);">‚Ä¢ Upscales non-square images to next power-of-2 (e.g., 3151√ó4096 ‚Üí 4096√ó4096)</span><br>
                                <span style="color: var(--text-secondary);">‚Ä¢ Pure JS, works in any browser without WASM support</span><br>
                                <span style="color: var(--text-secondary);">‚Ä¢ Separable 2D FFT: rows then columns (O(n¬≤ log n) complexity)</span>
                            </p>

                            <h3>7. Grid Prominence Score</h3>

                            <p>
                                The tool calculates a "Grid Prominence Score" by comparing peak power at cardinal angles (0¬∞, 90¬∞, 180¬∞, 270¬∞) against local averages. Higher ratios indicate stronger periodic artifacts characteristic of upsampling. The score is logged to the console but not displayed in the UI‚Äîit's used for internal analysis and future improvements.
                            </p>

                            <h3>8. References & Further Reading</h3>
                            <p style="font-size: 0.85rem; color: var(--text-secondary);">
                                ‚Ä¢ Detecting and Simulating Artifacts in GAN Fake Images (Zhang et al., 2019)<br>
                                ‚Ä¢ Checkerboard artifacts free convolutional neural networks (Sugawara, 2019)<br>
                                ‚Ä¢ Discrete Fourier Transform in Unmasking Deepfake Images (MDPI, 2024)<br>
                                ‚Ä¢ On the Frequency Bias of Generative Models (Schwarz et al., NeurIPS 2021)
                            </p>
                        </div>
                    </details>
                </div>
            </div>
        </main>

        <footer data-footer></footer>
    </div>

    <script type="module" src="../js/shared.js"></script>
    <script type="module" src="../js/footer.js"></script>
    <script type="module" src="../js/ai_image_detector/ai-image-detector.js"></script>
</body>
</html>